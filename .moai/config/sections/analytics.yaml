# Analytics Configuration
# ARIA Advanced Analytics Features Configuration

analytics:
  # Complaint Trend Analysis Settings
  complaint_analysis:
    # Minimum data points for reliable baseline calculation
    min_data_points: 100

    # Control limit multiplier for statistical process control
    # 2 = 95.4% confidence interval, 3 = 99.7% confidence interval
    control_limit_multiplier: 2

    # Default aggregation period (day, week, month, quarter)
    default_period: month

    # Anomaly severity thresholds (in standard deviations)
    severity_thresholds:
      medium: 2.0
      high: 3.0

    # Enable synthetic data generation for testing
    synthetic_data_enabled: true

    # Confidence score calculation
    confidence:
      # Minimum data points for high confidence
      high_confidence_threshold: 12

      # Medium confidence range
      medium_confidence_min: 6
      medium_confidence_max: 11

    # Alert settings
    alerts:
      # Enable automatic alert generation
      enabled: true

      # Alert channels (console, email, notion, slack)
      channels:
        - console

      # Minimum severity for alerts (medium, high)
      min_severity: medium

      # Include correlation analysis in alerts
      include_correlation: true

      # Include geographical cluster analysis
      include_geography: true

    # Correlation analysis settings
    correlation:
      # Minimum complaint count for lot correlation
      lot_threshold: 2

      # Minimum complaint count for geographical cluster
      geography_threshold: 1

      # Complaint types to analyze
      types_to_analyze:
        - Software Crash
        - UI Issue
        - Performance
        - Data Loss
        - Connectivity
        - Hardware Failure
        - Battery Issue

  # Regulatory Change Monitoring Settings
  regulatory_monitoring:
    # Check interval in hours
    check_interval: 24

    # Regulatory domains to monitor
    domains:
      - name: FDA
        enabled: true
        search_queries:
          - "FDA guidance updates"
          - "FDA medical device guidance"
          - "21 CFR updates"
          - "FDA SaMD guidance"

      - name: EU MDR
        enabled: true
        search_queries:
          - "EU MDR updates"
          - "European Commission medical device"
          - "MDR amendment"
          - "EUDAMED updates"

      - name: MFDS
        enabled: true
        search_queries:
          - "MFDS guidance updates"
          - "Korea medical device regulation"
          - "MFDS announcement"

    # Auto-flag affected documents
    auto_flag: true

    # Decision validation settings
    decision_validation:
      # Enable automatic decision validation
      enabled: true

      # Check interval for stored decisions
      check_interval_days: 7

      # Action when obsolete decision found
      obsolete_action: flag

    # Impact assessment settings
    impact_assessment:
      # Priority calculation weights
      priority_weights:
        pending_status: 3
        recent_update: 2
        direct_reference: 1

      # "Recent" threshold in days
      recent_threshold_days: 180

      # Maximum documents to flag per change
      max_flagged_documents: 50

  # Knowledge Base Settings
  knowledge_base:
    # Storage location
    path: .claude/agent-memory/aria/knowledge-base.json

    # Storage backend (json, notion, hybrid)
    storage_backend: json

    # Notion configuration (if using notion backend)
    notion:
      database_id: ""
      enabled: false

    # Search settings
    search:
      # Maximum entries to return in search
      max_results: 10

      # Minimum relevance score threshold (0-1)
      min_relevance_score: 0.3

      # Outcome priority boost
      outcome_boost:
        approved: 0.5
        approvable: 0.2
        not_approved: -0.3
        pending: 0.0

    # Content reuse settings
    reuse:
      # Require explicit confirmation for failed outcomes
      require_confirmation_failed: true

      # Require context validation
      require_validation: true

      # Warning types that block reuse
      blocking_warnings:
        - failed_outcome
        - regulation_change

    # Quality indicators
    quality:
      # Enable usage tracking
      track_usage: true

      # Enable user ratings
      enable_ratings: true

      # Minimum reuse count for "proven" status
      proven_threshold: 5

      # Minimum success rate for "reliable" status
      reliable_threshold: 0.8

  # MCP Integration Settings
  mcp_integration:
    # Context7 MCP settings
    context7:
      # Enable Context7 for regulation lookup
      enabled: true

      # Cache duration in hours
      cache_duration: 24

      # Resolve library IDs for regulations
      resolve_library_ids: true

    # Notion MCP settings
    notion:
      # Enable Notion for knowledge base storage
      enabled: false

      # Knowledge base database ID
      knowledge_base_id: ""

      # Regulation mapping database ID
      regulation_mapping_id: ""

      # Retry settings
      retry_attempts: 3
      retry_delay_ms: 1000

    # Google Workspace MCP settings
    google_workspace:
      # Enable for complaint data collection
      enabled: false

      # Complaint data spreadsheet ID
      spreadsheet_id: ""

      # Sheet name for complaint data
      sheet_name: "Complaints"

  # Performance Settings
  performance:
    # Enable caching
    caching_enabled: true

    # Cache size limits
    cache_size_mb: 100

    # Async operations
    async_enabled: true

    # Batch processing
    batch_size: 100

    # Timeout settings (seconds)
    timeouts:
      web_search: 30
      context7_lookup: 10
      notion_query: 15
      knowledge_base_search: 5

  # Logging Settings
  logging:
    # Enable analytics logging
    enabled: true

    # Log level (debug, info, warn, error)
    level: info

    # Log file path
    file: .moai/logs/analytics.log

    # Log format
    format: json

  # Testing Settings
  testing:
    # Enable test mode with synthetic data
    synthetic_data_mode: false

    # Synthetic data parameters
    synthetic:
      num_complaints: 150
      anomaly_multiplier: 2.0
      date_range_months: 3

    # Integration test settings
    integration:
      # Run integration tests on startup
      run_on_startup: false

      # Test data location
      test_data_path: .claude/tests/analytics/

  # Security Settings
  security:
    # Sanitize complaint data for PII
    sanitize_pii: true

    # Encryption for stored data
    encrypt_storage: false

    # Access control
    access_log_enabled: true
